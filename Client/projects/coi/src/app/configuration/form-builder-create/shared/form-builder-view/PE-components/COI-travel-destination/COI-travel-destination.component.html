<div class="mb-2 mt-1">
    <div class="card overflow-hidden card-bg-color">
        <div class="px-3 my-1 d-flex align-items-center">
            <div class="col fs-16 my-2">
                <!-- <span>Destination</span> -->
                <!-- <app-common-help-text [subSectionId]="Destination_DETAILS.sectionId" [elementId]="'coi-travel-destination'"></app-common-help-text> -->
                <label for="coi-travel-destination-details" class="question-font fb-question-font">
                    <span *ngIf="isEditMode" class="fb-mandatory fb-pt-1 fb-mr-1">*</span>
                    <span>Trip Details</span>
                    <app-common-help-text [subSectionId]="2401"
                        [elementId]="'coi-travel-destination-details'"></app-common-help-text>
                </label>
            </div>
            <div *ngIf="componentData?.travelDestinations?.length && isEditMode" class="col-auto">
                <button id="additional-address-add-button" class="d-inline-flex btn btn-primary fs-14"
                    title="Click here to add destination details" aria-label="Click here to add destination details"
                    (click)="addDestinationDetails(true)">
                    <mat-icon>add</mat-icon>
                    <span>Add Destination</span>
                </button>
            </div>
        </div>
        <div *ngIf="!componentData?.travelDestinations?.length">
            <div class="no-data-container w-100">
                <span class="no-data-icon-outer">
                    <div class="no-data-icon">
                      <mat-icon aria-hidden="true" class="no-file">folder_off</mat-icon>
                    </div>
                </span>
                  <h5 class="fs-16 mt-3">
                      <span *ngIf="!isEditMode" class="default-content">There are no destinations added.</span>
                      <span *ngIf="isEditMode" class="default-content">There are no destinations added. Click 'Add Destination' to add destination details.</span>
                  </h5>
                <button *ngIf="isEditMode" id="add-destination-no-information-add-btn"
                    class="d-inline-flex btn btn-primary fs-14" title="Click here to add destination details"
                    attr.aria-label="Click here to add destination details" (click)="addDestinationDetails($event)">
                    <mat-icon>add</mat-icon>
                    <span>Add Destination</span>
                </button>
            </div>
        </div>
        <div class="table-responsive coi-table-striped px-3">
            <table *ngIf="componentData?.travelDestinations?.length" class="table table-bordered fs-14 fw-medium table-striped"
                id="coi-keyperson-table-">
                <thead>
                    <tr class="header-border table-light" id="coi-project-overview-table-thead-">
                        <th style="width: 17%;" class="p-0 align-middle">
                            <span class="coi-text-darker px-3">Flight/Train Details</span>
                        </th>
                        <th style="width: 17%;" class="p-0 align-middle">
                            <span class="coi-text-darker px-3">Country</span>
                        </th>
                        <th style="width: 22%;" class="p-0 align-middle">
                            <span class="coi-text-darker px-3">City</span>
                        </th>
                        <th style="width: 17%;" class="p-0 align-middle">
                            <span class="coi-text-darker px-3">Date of Stay</span>
                        </th>
                        <th style="width: 20%;">
                            <span class="coi-text-darker px-3">Lodging</span>
                        </th>
                        <th style="width: 7%;" *ngIf="isEditMode" class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody class="white-bg">
                    <tr *ngFor="let destination of componentData.travelDestinations; let isLast = last; let i = index" class="tr-hover">
                        <td class="table-data fw-600 px-1 coi-text-light">
                            <div class="m-0 mb-2 row py-1">
                                <app-no-data-label [valueToShow]="destination?.travelMediumDetail">
                                    <span id="coi-travel-end-date-of-involvement" class="coi-text-light">{{
                                        destination?.travelMediumDetail}}</span>
                                </app-no-data-label>
                            </div>
                        </td>
                        <td class="px-1">
                            <div class="m-0 mb-2 row py-1 coi-text-light">
                                <app-no-data-label [valueToShow]="destination?.countryName">
                                    <span id="coi-travel-end-date-of-involvement" class="coi-text-light">{{
                                        destination?.countryName}}</span>
                                </app-no-data-label>
                            </div>
                        </td>
                        <td class="px-1 coi-text-light">
                            <div class="m-0 mb-2 row py-1">
                                <app-no-data-label [valueToShow]="destination?.city">
                                    <span id="coi-travel-end-date-of-involvement" class="coi-text-light">{{
                                        destination?.city}}</span>
                                </app-no-data-label>
                            </div>
                        </td>
                        <td class="px-1 coi-text-light">
                            <div class="m-0 mb-2 row py-1">
                                <span id="coi-travel-end-date-of-involvement"
                                    class="coi-text-light">{{destination?.stayStartDate
                                    |dateFormatter}} - {{destination?.stayEndDate |dateFormatter}}</span>
                            </div>
                        </td>
                        <td class="px-1 coi-text-light">
                            <div class="m-0 mb-2 row py-1">
                                <app-no-data-label [valueToShow]="destination?.placeOfStay">
                                    <span id="coi-travel-end-date-of-involvement" class="coi-text-light">{{
                                        destination?.placeOfStay}}</span>
                                </app-no-data-label>
                            </div>
                        </td>
                        <td class="p-0 align-middle" *ngIf="isEditMode">
                            <div class="d-flex justify-content-end">
                                <mat-icon aria-hidden="true"
                                    class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                    (click)="editDestinationDetails(destination, i)"
                                    title="Click here to update Destination details"
                                    aria-label="Click here to update Destination details"
                                    (keypress.enter)="editDestinationDetails(destination, i)">edit</mat-icon>
                                <mat-icon aria-hidden="true"
                                    class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                    (click)="confirmDelete(destination, i)"
                                    title="Click here to delete Destination details"
                                    aria-label="Click here to delete Destination details"
                                    (keypress.enter)="confirmDelete(destination, i)">delete</mat-icon>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- open add destination details -->
    <div class="modal modal-xl fade mySkinDialog" data-bs-backdrop="static" id="addDestinationDetails" role="dialog"
        tabindex="-1" aria-labelledby="addDestinationDetails-header">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="addDestinationDetails-header">Add Destination</h4>
                    <button type="button" class="btn-close" id="coi-add-Destination-details-close-btn" [class.d-none]="hideDestModalCloseBtn"
                        title="Click here to close" data-bs-dismiss="modal" aria-label="Click here to close"
                        (click)="clearDestinationDetails()"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-12 col-lg-4 mt-sm-2 mt-lg-0">
                            <label class="fs-14 fw-500 pb-1 coi-label-help" for="coi-city-name">
                                Flight/Train Details
                            </label>
                            <input type="text" class="form-control fs-13" id="coi-travelMediumDetail-name"
                                name="coi-travelMediumDetail-name"
                                [ngClass]="(mandatoryList?.has('travelMediumDetail')) ? 'is-invalid d-block' : ''"
                                [(ngModel)]="destinationDetails.travelMediumDetail" appLengthValidator [limit]="30">
                            <div *ngIf="mandatoryList?.has('travelMediumDetail')"
                                class="invalid-feedback d-block fs-13">
                                {{mandatoryList?.get('travelMediumDetail')}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-lg-4 mt-sm-2 mt-lg-0">
                            <label class="fs-14 fw-500 pb-1 coi-label-help" for="coi-country-name">
                                <span class="mandatory me-1">*</span>Country
                            </label>
                            <app-endpoint-search (onSelect)="selectTravelCountry($event)"
                                [clearField]="countryClearField" [httpOptions]="countrySearchOptions"
                                [uniqueId]="'travelDisclosure-countryList'" (change)="setUnSavedChangesTrue();"
                                autocomplete="off" [isError]="(mandatoryList?.has('country'))? true: false">
                            </app-endpoint-search>
                            <div *ngIf="mandatoryList?.has('country')" class="invalid-feedback d-block fs-13">
                                {{mandatoryList?.get('country')}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-lg-4 mt-sm-2 mt-lg-0">
                            <label class="fs-14 fw-500 pb-1 coi-label-help" for="coi-city-name">
                                <span class="mandatory me-1">*</span>City
                            </label>
                            <input type="text" class="form-control fs-13" id="coi-city-name" name="coi-city-name"
                                [ngClass]="(mandatoryList?.has('city')) ? 'is-invalid d-block' : ''"
                                [(ngModel)]="destinationDetails.city" appLengthValidator [limit]="30">
                            <div *ngIf="mandatoryList?.has('city')" class="invalid-feedback d-block fs-13">
                                {{mandatoryList?.get('city')}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-lg-4 mt-sm-2 mt-lg-0 mt-2">
                            <div class="row">
                                <div class="col-lg-12">
                                    <label class="fs-14 fw-500 pb-1 coi-label-help">
                                        <span class="mandatory me-1">*</span>Dates of Stay
                                        <!-- <app-common-help-text [subSectionId]="Destination_DETAILS.sectionId" [elementId]="'coi-entity-Destination-number'"></app-common-help-text> -->
                                    </label>
                                </div>
                                <div class="col-lg-5">
                                    <span class="dateField d-block">
                                        <input #fromDateInput matInput [matDatepicker]="stayStartDate"
                                            id="travel-discl-stay-start" placeholder={{datePlaceHolder}}
                                            (click)="stayStartDate.open()" autocomplete="off"
                                            class="d-inline-block form-control w-100"
                                            [(ngModel)]="destinationDetails.stayStartDate"
                                            (ngModelChange)="validateDateFormat('fromDate'); setUnSavedChangesTrue();"
                                            (dateChange)="validateDateFormat('fromDate')" (blur)="validateDateFormat('fromDate')"
                                            (keypress)="commonService._keyPress($event, 'date')"
                                            [ngClass]="(dateValidationList?.get('stayStartDate')) ? 'invalid-border':''" />
                                        <i (click)="stayStartDate.open()"
                                            class="fa fa-calendar fa-large insidePicker hand-cursor me-2"></i>
                                        <mat-datepicker #stayStartDate></mat-datepicker>
                                    </span>
                                    <app-common-information [elementId]="'travel-discl-stay-start'"
                                        [subSectionId]="2401"></app-common-information>
                                    <span *ngIf="(dateValidationList.get('stayStartDate') && !dateFormatValidationMap.get('fromDate'))"
                                        class="fs-13 invalid-feedback d-block">
                                        {{dateValidationList.get('stayStartDate')}}
                                    </span>
                                    <span class="invalid-feedback d-block fs-13" *ngIf="dateFormatValidationMap.get('fromDate')">
                                        {{dateFormatValidationMap.get('fromDate')}}
                                    </span>
                                </div>
                                <div
                                    class="align-items-center col-lg d-flex justify-content-center">
                                    To
                                </div>
                                <div class="col-lg-5">
                                    <span class="dateField d-block">
                                        <input #toDateInput matInput [matDatepicker]="stayEndDate" id="travel-disclosure-stay-end"
                                            placeholder={{datePlaceHolder}} (click)="stayEndDate.open()"
                                            autocomplete="off" class="d-inline-block form-control w-100"
                                            [(ngModel)]="destinationDetails.stayEndDate"
                                            (ngModelChange)="validateDateFormat('toDate'); setUnSavedChangesTrue();"
                                            (dateChange)="validateDateFormat('toDate')" (blur)="validateDateFormat('toDate')"
                                            (keypress)="commonService._keyPress($event, 'date')"
                                            [ngClass]="(dateValidationList?.get('stayEndDate')) ? 'invalid-border':''" />
                                        <i (click)="stayEndDate.open()"
                                            class="fa fa-calendar fa-large insidePicker hand-cursor me-2"></i>
                                        <mat-datepicker #stayEndDate></mat-datepicker>
                                    </span>
                                    <app-common-information [elementId]="'travel-disclosure-stay-end'"
                                        [subSectionId]="2401"></app-common-information>
                                    <span *ngIf="(dateValidationList.get('stayEndDate') && !dateFormatValidationMap.get('toDate'))"
                                        class="fs-13 invalid-feedback d-block">
                                        {{dateValidationList.get('stayEndDate')}}
                                    </span>
                                    <span *ngIf="dateFormatValidationMap.get('toDate')" class="invalid-feedback d-block fs-13">
                                        {{dateFormatValidationMap.get('toDate')}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 col-lg-4 mt-sm-2 mt-lg-0">
                            <label class="fs-14 fw-500 pb-1 coi-label-help" for="coi-stay-name">
                                Lodging
                            </label>
                            <input type="text" class="form-control fs-13" id="coi-stay-name" name="coi-stay-name"
                                [(ngModel)]="destinationDetails.placeOfStay" appLengthValidator [limit]="50">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" id="coi-add-entity-Destination-details-cancel-btn"
                        name="coi-add-entity-Destination-details-cancel-btn" type="button" title="Click here to cancel"
                        aria-label="Click here to cancel" (click)="clearDestinationDetails()">
                        Cancel
                    </button>
                    <button class="btn btn-primary me-0" id="coi-add-entity-destination-details-add-btn"
                        name="coi-add-entity-Destination-details-add-btn" type="button"
                        title="Click here to {{editIndex != -1 ? 'update': 'add'}} Destination details"
                        attr.aria-label="Click here to {{editIndex != -1 ? 'update': 'add'}} Destination details"
                        (click)="addDestination()">
                        {{editIndex != -1 ? 'Update':'Add'}} Destination
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="modal fade" data-bs-backdrop="static" id="travelDestinationDeleteConfirm"
        role="dialog" tabindex="-1" aria-labelledby="travelDestinationDeleteConfirm-header">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="travelDestinationDeleteConfirm-header">Confrimation</h4>
                    <button type="button" class="btn-close" id="coi-delete-close-btn"
                        title="Click here to close" data-bs-dismiss="modal" aria-label="Click here to close"
                        (click)="clearDestinationDetails()"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this Destination?</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" id="coi-delete-cancel-btn"
                        name="coi-delete-cancel-btn" type="button" title="Click here to cancel"
                        aria-label="Click here to cancel" (click)="cancelTriggerInDeleteConfirm()">
                        Cancel
                    </button>
                    <button class="btn btn-primary me-0" id="coi-delete-confirm-btn"
                        name="coi-delete-confirm-btn" type="button"
                        title="Click here to delete destination details"
                        attr.aria-label="Click here to delete destination details" (click)="deleteDestination()">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
