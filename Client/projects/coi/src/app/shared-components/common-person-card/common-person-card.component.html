<article class="card coi-card-regular shadow-sm {{customClass}}">
    <div class="card-body">
        <div class="row row-gap-2">
            <ng-container *ngFor="let fieldOrder of cardOrder">
                <!-- Person Name -->
                <ng-container *ngIf="fieldOrder === 'PERSON_NAME'">
                    <ng-container *ngTemplateOutlet="textFieldTemplate; context: { cssClass: 'col-lg-4 col-md-6',
                        label: 'Name', value: personDetails?.fullName }"></ng-container>
                </ng-container>
                <!-- Appointment Title -->
                <ng-container *ngIf="fieldOrder === 'APPOINTMENT_TITLE'">
                    <ng-container *ngTemplateOutlet="textFieldTemplate; context: { cssClass: 'col-lg-4 col-md-6',
                        label: 'Appointment Title', value: personDetails?.primaryTitle || personDetails?.designation }"></ng-container>
                </ng-container>
                <!-- Email Address -->
                <ng-container *ngIf="fieldOrder === 'EMAIL_ADDRESS'">
                    <ng-container *ngTemplateOutlet="textFieldTemplate; context: { cssClass: 'col-lg-4 col-md-6',
                        label: 'Email Address', value: personDetails?.emailAddress }"></ng-container>
                </ng-container>
                <!-- Department -->
                <ng-container *ngIf="fieldOrder === 'DEPARTMENT'">
                    <ng-container *ngTemplateOutlet="textFieldTemplate; context: { cssClass: 'col-lg-4 col-md-6',
                        label: COMMON_DISCL_LOCALIZE.COMMON_DEPARTMENT, value: personDetails?.unit?.displayName }"></ng-container>
                </ng-container>
                <!-- Department -->
                <ng-container *ngIf="fieldOrder === 'ORGANIZATION'">
                    <ng-container *ngTemplateOutlet="textFieldTemplate; context: { cssClass: 'col-lg-4 col-md-6',
                        label: 'Organization', value: organization }"></ng-container>
                </ng-container>
            </ng-container>
        </div>
    </div>
</article>

<!-- Field Template -->
<ng-template #textFieldTemplate let-cssClass="cssClass" let-label="label" let-value="value"
    let-innerTemplate="innerTemplate">
    <div [ngClass]="cssClass" [attr.aria-label]="label + ' is ' + value">
        <span class="d-block coi-text-dark">{{ label }}</span>
        <span class="coi-text-light text-slice" [title]="value">
            <app-no-data-label [valueToShow]="value"></app-no-data-label>
            <ng-container *ngTemplateOutlet="innerTemplate"></ng-container>
        </span>
    </div>
</ng-template>
