DELIMITER //
CREATE FUNCTION FN_CHK_INACTV_ENTITY(
    AV_DISCLOSURE_ID INT
) RETURNS varchar(6) 
    DETERMINISTIC
BEGIN
	DECLARE LI_SFI_FLAG INT DEFAULT 0;
	
			SELECT COUNT(*) INTO  LI_SFI_FLAG
  		    FROM COI_DISCL_PROJECT_ENTITY_REL t1
            INNER JOIN COI_DISCL_PROJECTS t4 ON t4.COI_DISCL_PROJECTS_ID = t1.COI_DISCL_PROJECTS_ID
            INNER JOIN PERSON_ENTITY t2 ON t2.PERSON_ENTITY_ID = t1.PERSON_ENTITY_ID
            INNER JOIN ENTITY t3 ON t3.ENTITY_NUMBER = t2.ENTITY_NUMBER
            WHERE t4.DISCLOSURE_ID = AV_DISCLOSURE_ID AND t3.DOCUMENT_STATUS_TYPE_CODE = '2' AND t3.VERSION_STATUS = 'ACTIVE';
			
			
		IF LI_SFI_FLAG > 0 THEN 
		RETURN 'TRUE';		
		END IF;  
RETURN 'FALSE';
END;
//
