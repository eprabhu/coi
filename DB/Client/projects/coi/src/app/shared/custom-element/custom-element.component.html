<div class="card {{customCardClass}}" *ngIf="customElements.length">
    <!-- <div class="card-header p-3" *ngIf="tabName == 'OI'">
         <h4 class="card-title">Other Information
         </h4>
         <div class="text-right ml-5" *ngIf="isShowCollapse">
             <span>
                 <button class="updown-arrow" (click)="isShowOtherInfo = !isShowOtherInfo">
                 <i [ngClass]="!isShowOtherInfo?'fa-large fa fa-angle-double-down':'fa-large fa fa-angle-double-up'"
                 class="fa-large" aria-hidden="true"></i>
                 </button>
             </span>
         </div>
     </div>-->
    <div class="card-content">

        <!--<div class="no-data-container" *ngIf="(customElements == null || customElements?.length == 0) && isShowOtherInfo && tabName == 'OI';">
            <span class="no-data-icon-outer">
                    <div class="no-data-icon">
                        <i class="fa fa-file-o" aria-hidden="true"></i>
                        <i class="fa fa-times-circle-o" aria-hidden="true"></i>
                    </div>
                </span>
                <h4>There is no information in this section.</h4>
        </div>-->

        <div id="custom-element-body" class="card-body {{customBodyClass}}"
             *ngIf="(customElements != null && customElements?.length != 0 && isShowOtherInfo)">
            <div class="row">
                <div class="" *ngFor="let list of customElements; let i = index"
                     [ngClass]="list.filterType == 'Text'?'col-12':'col-xl-3 col-lg-3 col-sm-12 col-12'">
                    <div [ngSwitch]="true">
                        <div *ngSwitchCase="list.filterType == 'String' || list.filterType =='Number'">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <span *ngFor="let answer of list?.answers">
                                <span *ngIf="viewMode == 'view'">
                                    <span class="d-block"
                                          [ngClass]="(answer.value !== null && answer.value !== '') ? 'text-color' : 'noDataExists fs-14 fw-500'">{{
                                            (answer.value
                                                !== null && answer.value !== '') ? answer.value : '- No Data -'
                                        }}</span>
                                </span>
                                <span *ngIf="viewMode != 'view'">
                                    <input appTailingSpaceRemover type="text" *ngIf="viewMode !== 'view'"
                                        [id]="'adv-search-proposal-no'+i" (ngModelChange)="checkPreviousAndNewValue(answer.value, $event, list);"
                                        [(ngModel)]="answer.value"
                                        placeholder="{{ list.columnName }}" class="form-control mb-2"
                                        (keyup)="checkValidation(answer,$event,list,i)"
                                        [ngClass]="!isValueEmpty[i]&&validationId[i]==i ? 'is-invalid d-block' : ''"
                                        (ngModelChange)="autoSave(list, DEBOUNCE_REQUIRED)"/></span></span>
                            <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                            <span *ngIf="isType&&numberValidationId==i" class="invalid-feedback d-block">
                                Please Enter Numbers.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Text'">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <span *ngFor="let answer of list?.answers">
                                <span *ngIf="viewMode == 'view'">
                                    <span class="d-block noDataExists fs-14 fw-500"
                                          *ngIf="!answer.value">- No Data -</span>
                                    <div class="d-flex"
                                         (click)="collapseViewMoreOption(list?.customDataElementId, collapseViewMore[list?.customDataElementId])">
                                    <span class="text-color">
                                      {{
                                            answer.value.length > 480 && !collapseViewMore[list?.customDataElementId] ?
                                                (answer.value | slice:0:480) + '...' : answer.value
                                        }}
                                        <span *ngIf="answer.value.length > 480" class="collapse-text">
                                        {{ collapseViewMore[list?.customDataElementId] ? "Show Less" : "Read More" }}
                                      </span>
                                    </span>
                                  </div>
                                </span>
                                <span *ngIf="viewMode != 'view'">
                                    <textarea appTailingSpaceRemover type="text" appAutoGrow appLengthValidator
                                        [isShowLimiter]='true' rows="4"
                                        *ngIf="viewMode !== 'view'" id="adv-search-proposal-no"
                                        (ngModelChange)="checkPreviousAndNewValue(answer.value, $event, list);
                                        autoSave(list, DEBOUNCE_REQUIRED)"
                                        [(ngModel)]="answer.value" placeholder="{{ list.columnName }}"
                                        [styleList]="'text-end word-count float-end ms-2 mt-2'"
                                        class="form-control">
                                    </textarea></span></span>
                            <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                            <span *ngIf="isType&&numberValidationId==i" class="invalid-feedback d-block">
                                Please Enter numbers.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Date' ">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <span *ngFor="let answer of list?.answers">
                                <span *ngIf="viewMode == 'view'">
                                    <span class="d-block"
                                          [ngClass]="answer.value !== null ? 'text-color' : 'noDataExists fs-14 fw-500'">{{ answer.value ? (answer.value | dateFormatter) : '- No Data -' }}</span></span>
                                <span *ngIf="viewMode != 'view'">
                                    <span class="dateField mr-1">
                                        <input matInput [matDatepicker]="customDt"
                                               placeholder="From ({{datePlaceHolder}})"
                                               id="{{list.columnName}}" class="d-inline-block form-control"
                                               autocomplete="off"
                                               [ngModel]="answer.value ?  answer.value : list.defaultValue"
                                               [(ngModel)]="answer.value"
                                               [ngClass]="!isValueEmpty[i]&&validationId[i]==i ? 'is-invalid d-block' : '' "
                                               (keypress)="_commonService._keyPress($event, 'date');"
                                               (ngModelChange)="answer.value = parseDateWithoutTimestamp(answer.value);
                                                             emitDataChange();
                                                             autoSave(list)"
                                               (click)="customDt.open()">
                                        <i class="fa fa-calendar fa-large insidePicker hand-cursor"
                                           (click)="customDt.open()" aria-hidden="true"></i>
                                        <mat-datepicker #customDt
                                                        (opened)="setFocusToElement(list.columnName)"></mat-datepicker>
                                    </span>
                                </span>
                            </span>
                            <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Check Box'">
                            <span *ngIf="list.options.length > 0">
                                <span class="mandatory" *ngIf="list.isRequired == 'Y'">*</span>
                                <label>{{ list.columnName }}
                                    <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                                </label>
                                <div class="d-flex align-items-center col-12"
                                     *ngFor="let option of list.options;  let checkBoxIndex=index">
                                    <input type="checkbox" [disabled]="viewMode == 'view'"
                                           [checked]="checkIsSelected(list.answers, option.customDataOptionId)"
                                           id="{{option.optionName}}{{i}}"
                                           (change)="setAnswerForCheckBox(list, $event.target.checked, option);
                                                  emitDataChange();
                                                  autoSave(list)"/>
                                    <label for="{{option.optionName}}{{i}}"
                                           [ngClass]="{'hand-cursor': viewMode != 'view' }"
                                           class="ms-2">{{ option.optionName }}</label>
                                </div>
                            </span>
                            <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                            <span *ngIf="!checkEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Radio Button'">
                            <span *ngIf="list.options.length > 0">
                                <span class="mandatory"
                                      *ngIf="list.isRequired == 'Y'">*</span>
                                <label>{{ list.columnName }}
                                    <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                                </label>
                                <div class="d-flex align-items-center col-12" *ngFor="let option of list.options">
                                    <input type="radio" [disabled]="viewMode == 'view'" [value]="option.optionName"
                                           name="{{option.optionName}}{{i}}" id="{{option}}{{i}}"
                                           [(ngModel)]="list.answers[0].value"
                                           (ngModelChange)="emitDataChange();
                                                         autoSave(list)"/>
                                        <label for="{{option.optionName}}{{i}}"
                                               [ngClass]="{'hand-cursor': viewMode != 'view' }"
                                               class="ms-2">{{ option.optionName }}</label>
                                </div>
                                <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                            </span>
                            <span *ngIf="!radioEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'System Dropdown' || list.filterType == 'User Dropdown'">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <div *ngIf="list.isMultiSelectLookup == 'Y'; else singleValueSelect">
                                <span *ngIf="viewMode != 'view'">
                                    <app-look-up [options]="getLookUpArgument(list.lookupArgument)"
                                                 [isDisabled]="viewMode == 'view'"
                                                 [selectedLookUpList]="lookUpValues[list.customDataElementId]"
                                                 [isError]="(!isValueEmpty[i]&&validationId[i]==i) ? true : false"
                                                 (selectedResult)="onLookupSelect($event,list)">
                                    </app-look-up>
                                <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                                </span>
                                <div *ngIf="list?.answers?.length" class="col mb-0 pl-0 fileChips">
                                    <ng-container *ngFor="let answer of list.answers">
                                        <span class="mb-0 px-3" *ngIf="answer.value">{{ answer?.description }}
                                        </span>
                                    </ng-container>
                                </div>
                                <div
                                    *ngIf="list?.answers?.length == 1 && !list?.answers[0].value && viewMode == 'view'">
                                    <span class="d-block noDataExists fs-14 fw-500">- No Data -</span>
                                </div>
                            </div>
                            <ng-template #singleValueSelect>
                                <ng-container *ngIf="viewMode != 'view'">
                                    <app-look-up [options]='list.lookupArgument'
                                                 [selectedLookUpList]="lookUpValues[list.customDataElementId]"
                                                 [isError]="(!isValueEmpty[i]&&validationId[i]==i) ? true : false"
                                                 (selectedResult)="onLookupSelect($event,list)"
                                                 [defaultValue]="list.answers[0] ? list.answers[0].description : ''">
                                    </app-look-up>
                                <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                                </ng-container>
                                <span *ngIf="viewMode == 'view'">
                                        <span class="d-block text-color"
                                              *ngIf="list.answers[0].description">{{ list.answers[0].description }}</span>
                                        <span class="d-block noDataExists fs-14 fw-500"
                                              *ngIf="!list.answers[0].description">- No Data -</span>
                                </span>
                            </ng-template>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Elastic Search'">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <span *ngFor="let answer of list?.answers">
                                <span *ngIf="viewMode == 'view'">
                                    <span class="d-block"
                                          [ngClass]="answer.description !== null ? 'text-color' : 'noDataExists fs-14 fw-500'">{{ answer.description !== null ? answer.description : '- No Data -' }}</span></span>
                                <span *ngIf="viewMode != 'view'">
                                    <div class="position-relative">
                                        <app-elastic [options]="elasticSearchOptions[list.columnName]"
                                                     [placeHolder]="'Type here for ' + list.columnName"
                                                     (selectedResult)="setSearchFilterValue($event,answer,list)"
                                                     [isError]="(!isValueEmpty[i]&&validationId[i]==i) ? true : false">
                                        </app-elastic>
                                    <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                                    </div>
                                </span></span>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>
                        <div *ngSwitchCase="list.filterType == 'Autosuggest'">
                            <span class="mandatory" *ngIf="list.isRequired == 'Y' && viewMode !== 'view'">*</span>
                            <label>{{ list.columnName }}
                                <app-common-help-text [helpTextHardCoded]="list.helpLink"></app-common-help-text>
                            </label>
                            <span *ngFor="let answer of list?.answers">
                                <span *ngIf="viewMode == 'view'">
                                    <span class="d-block"
                                          [ngClass]="answer.description !== null ? 'text-color' : 'noDataExists fs-14 fw-500'">{{ answer.description !== null ? answer.description : '- No Data -' }}</span></span>
                                <span *ngIf="viewMode != 'view'">
                                    <div class="position-relative">
                                        <app-endpoint-search [httpOptions]="endPointSearchOptions[list.columnName]"
                                                             [placeHolder]="'Type here for ' + list.columnName"
                                                             (onSelect)="setSearchFilterValue($event,answer,list)"
                                                             [isError]="(!isValueEmpty[i]&&validationId[i]==i) ? true : false">
                                        </app-endpoint-search>
                                    <app-common-information [hardCodedText]="list.helpDescription| customTagRemover: currentMethod"></app-common-information>
                                    </div>
                                </span></span>
                            <span *ngIf="!isValueEmpty[i]&&validationId[i]==i" class="invalid-feedback d-block">
                                This field is missing please check.
                            </span>
                        </div>

                    </div>
                </div>
            </div>
            <div class="row flex-column flex-sm-row justify-content-md-end justify-content-center mt-3 px-3"
                 *ngIf="viewMode!=='view' && isShowSave">
                <button class="btn btn-primary-sub btn-xs" (click)="saveCustomData()">Save</button>
            </div>
        </div>
    </div>
</div>

<div id="retry-autosave-toast"
     class="invisible alert alert-danger fs-14 px-3 retry-toast text-dark d-flex align-items-center">
    Changes not saved. <i class="fa fa-exclamation-triangle pl-2"></i>
    <span class="hand-cursor text-primary pl-2" (click)="processAutoSaveQueue()">Retry?</span>
</div>
