<div class="row header-sticky mb-2" id="COI_OPA_HEADER">
    <div class="col-12">
        <!-- new top card -->
        <div class="card coi-card-expanded">
            <div class="row mx-0">
                <div class="col-xl px-0">
                    <div class="card-header px-3 border-0">
                        <div class="row flex-grow-1 position-relative m-0">
                            <div class="d-flex col-12 px-0 coi-card-header-notch-container">
                                <!-- badge -->
                                <div class="d-flex mb-auto" tabindex="-1" aria-label="OPA disclosure">
                                    <span class="coi-card-notch-ribbon shadow-sm bg-opa-clip">OPA - {{opa?.opaDisclosure?.versionNumber === opaInitialVersion ? 'Initial' : 'Revision'}}</span>
                                </div>
                                <div class="col row m-0">
                                    <div class="col-12 d-flex justify-content-between p-0">
                                        <!-- person -->
                                        <span class="d-flex align-items-center coi-text-light ms-2 mt-1 text-nowrap">
                                            <mat-icon aria-hidden="true"
                                                class="fw-bolder coi-text-light flex-shrink-0 coi-mat-icon-size me-1">person</mat-icon>
                                            <a class="link-primary cursor-pointer text-slice" tabindex="0" (click)="openPersonDetailsModal()"
                                                (keyup.enter)="openPersonDetailsModal()" (keyup.space)="openPersonDetailsModal()"
                                                attr.aria-label="Click here to view details of {{opa?.opaDisclosure?.personName}}"
                                                title="Click here to view details of {{opa?.opaDisclosure?.personName}}">{{opa?.opaDisclosure?.personName}}
                                            </a>
                                        </span>
                                        <!-- links -->
                                        <div class="d-flex justify-content-end align-items-center f-14 ms-auto mt-auto me-3">
                                            <!-- <span class="ms-2 me-2"  role="link"
                                                [title]="0 ? 'Click here to view trainings' : ''"
                                                [attr.aria-label]="0 ? 'Click here to view trainings' : ''"
                                                [ngClass]="0 ? 'link-primary cursor-pointer' : 'coi-text-light text-decoration-none'" tabindex="-1">
                                                Trainings({{0}})
                                            </span> | -->
                                            <a class="ms-2 me-2 fs-13" (click)="openSlider('ENTITY', opa?.opaDisclosure?.personEntitiesCount)" id="coi-opa-disc-engagement-tab"
                                                role="link" (keyup.enter)="openSlider('ENTITY', opa?.opaDisclosure?.personEntitiesCount)"
                                                (keyup.space)="openSlider('ENTITY', opa?.opaDisclosure?.personEntitiesCount)"
                                                [title]="opa?.opaDisclosure?.personEntitiesCount ? 'Click here to view edit' : ''"
                                                [attr.aria-label]="opa?.opaDisclosure?.personEntitiesCount ? 'Click here to view engagements' : ''"
                                                [ngClass]="opa?.opaDisclosure?.personEntitiesCount ? 'link-primary cursor-pointer' : 'coi-text-light text-decoration-none'"
                                                [tabIndex]="opa?.opaDisclosure?.personEntitiesCount > 0 ? 0 : -1">
                                                Engagements<ng-container *ngIf="opa?.opaDisclosure?.personEntitiesCount">({{opa?.opaDisclosure?.personEntitiesCount}})</ng-container>
                                            </a>
                                            <span *ngIf="commonService.canShowReporterNotes"> | </span>
                                            <a *ngIf="commonService.canShowReporterNotes" class="ms-2 me-2 fs-13" (click)="openSlider('NOTES', opa?.opaDisclosure?.personNotesCount)" role="link"
                                                (keyup.enter)="openSlider('NOTES', opa?.opaDisclosure?.personNotesCount)" id="coi-opa-disc-notes-tab"
                                                (keyup.space)="openSlider('NOTES', opa?.opaDisclosure?.personNotesCount)"
                                                [title]="opa?.opaDisclosure?.personNotesCount ? 'Click here to view notes' : ''"
                                                [attr.aria-label]="opa?.opaDisclosure?.personNotesCount ? 'Click here to view notes' : ''"
                                                [ngClass]="opa?.opaDisclosure?.personNotesCount ? 'link-primary cursor-pointer' : 'coi-text-light text-decoration-none'" tabindex="0"
                                                [tabIndex]="opa?.opaDisclosure?.personNotesCount > 0 ? 0 : -1" >
                                                Notes<ng-container *ngIf="opa?.opaDisclosure?.personNotesCount">({{opa?.opaDisclosure?.personNotesCount}})</ng-container>
                                            </a>
                                            <span *ngIf="commonService.canShowReporterAttachments"> | </span>
                                            <a *ngIf="commonService.canShowReporterAttachments" class="ms-2 me-2 fs-13" id="coi-opa-disc-attachment-tab"
                                                (click)="openSlider('ATTACHMENTS', opa?.opaDisclosure?.personAttachmentsCount)" role="link"
                                                (keyup.enter)="openSlider('ATTACHMENTS', opa?.opaDisclosure?.personAttachmentsCount)"
                                                (keyup.space)="openSlider('ATTACHMENTS', opa?.opaDisclosure?.personAttachmentsCount)"
                                                [title]="opa?.opaDisclosure?.personAttachmentsCount ? 'Click here to view attachments' : ''"
                                                [attr.aria-label]="opa?.opaDisclosure?.personAttachmentsCount ? 'Click here to view attachments' : ''"
                                                [ngClass]="opa?.opaDisclosure?.personAttachmentsCount ? 'link-primary cursor-pointer' : 'coi-text-light text-decoration-none'"
                                                [tabIndex]="opa?.opaDisclosure?.personAttachmentsCount > 0 ? 0 : -1">
                                                Attachments<ng-container *ngIf="opa?.opaDisclosure?.personAttachmentsCount">({{opa?.opaDisclosure?.personAttachmentsCount}})</ng-container>
                                            </a>
                                            <ng-container *ngIf="isShowOverAllHistory">
                                                <span>|</span>
                                                <a class="ms-2 fs-13 link-primary cursor-pointer" id="coi-opa-disc-overall-history"
                                                    (click)="openHistorySlider()" role="link"
                                                    (keyup.enter)="openHistorySlider()"
                                                    title='Click here to view entire disclosure history' attr.aria-label='Click here to view entire disclosure history' tabIndex="0">
                                                    Disclosure History
                                                </a>
                                            </ng-container>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 d-flex p-0 align-items-center">
                                <!-- email -->
                                <span *ngIf="personProjectDetails?.personEmail" class="d-flex align-items-center coi-text-light mt-1"
                                    [title]="personProjectDetails?.personEmail">
                                    <mat-icon aria-hidden="true"
                                        class="fw-bolder coi-text-light flex-shrink-0 coi-mat-icon-size me-1">mail</mat-icon>
                                    <span class="text-slice">{{ personProjectDetails?.personEmail }}</span>
                                </span>
                                <!-- home unit -->
                                <span *ngIf="personProjectDetails?.unitDisplayName" class="d-flex align-items-center coi-text-light ms-3 mt-1"
                                    [title]="personProjectDetails?.unitDisplayName">
                                    <mat-icon aria-hidden="true"
                                        class="fw-bolder coi-text-light flex-shrink-0 coi-mat-icon-size me-1">home</mat-icon>
                                    <span class="text-slice">{{ personProjectDetails?.unitDisplayName }}</span>
                                </span>
                                <!-- title -->
                                <span *ngIf="personProjectDetails?.personPrimaryTitle"
                                    class="d-flex align-items-center coi-text-light ms-3 mt-1"
                                    [title]="personProjectDetails?.personPrimaryTitle">
                                    <mat-icon aria-hidden="true"
                                        class="fw-bolder coi-text-light flex-shrink-0 coi-mat-icon-size me-1">work</mat-icon>
                                    <span class="text-slice">{{ personProjectDetails?.personPrimaryTitle }}</span>
                                </span>
                            </div>
                            <button (click)="collapseHeader()"
                                title="Click here to {{isCardExpanded ? 'collapse' : 'view'}} OPA Disclosure"
                                attr.aria-label="Click here to {{isCardExpanded ? 'collapse' : 'view'}} OPA Disclosure"
                                class="toggle-btn align-items-center border btn d-flex justify-content-center p-0 rounded-5 shadow-sm toggle-btn-position">
                                <mat-icon aria-hidden="true" class="collapse-icon">{{isCardExpanded ? 'expand_less' : 'expand_more'}}</mat-icon>
                            </button>
                        </div>
                    </div>
                    <div class="card-body" *ngIf="isCardExpanded" id="coi-opa-card">
                        <div class="row gap-0">
                            <div *ngIf="isShowAdminDetails" class="col-6 col-xxl-4">
                                <div class="coi-box-red border border-secondary border-opacity-50 fw-medium p-3 rounded-1 h-100 position-relative">
                                    <span class="coi-text-darker fs-6 coi-field-set">Details</span>
                                    <div class="row row-gap-2">
                                        <div class="col-lg-6">
                                            <label class="coi-text-dark d-block">
                                                <i aria-hidden="true"
                                                    class="fa fa-user-o fw-700 me-1"></i>Administrator
                                            </label>
                                            <span class="coi-text-light">
                                                <app-no-data-label [valueToShow]="opa?.opaDisclosure?.adminPersonName">
                                                <span>{{opa?.opaDisclosure?.adminPersonName}}</span>
                                            </app-no-data-label></span>
                                        </div>
                                        <div class="col">
                                            <label class="coi-text-dark d-block">
                                                <img alt="add-adminGroup icon" class="activity-icon"
                                                    src="assets/images/multiple-admin-1.svg">Admin Group
                                            </label>
                                            <span class="coi-text-light">
                                                <app-no-data-label [valueToShow]="opa?.opaDisclosure?.adminGroupId">
                                                    <span>{{opa?.opaDisclosure?.adminGroupName}}</span>
                                                </app-no-data-label>
                                            </span>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div [ngClass]="isShowAdminDetails ? 'col-6 col-lg-6 col-xxl-4' : 'col-6'">
                                <div class="coi-box-red border border-secondary border-opacity-50 fw-medium p-3 rounded-1 h-100 position-relative">
                                    <span class="coi-text-darker fs-6 coi-field-set">Dates</span>
                                    <div class="row row-gap-2">
                                        <div class="col">
                                            <span class="coi-text-dark d-block"> Create</span>
                                            <span class="coi-text-light">
                                                <app-no-data-label [valueToShow]="opa?.opaDisclosure?.createTimestamp">
                                                    <span>{{opa?.opaDisclosure?.createTimestamp | dateFormatterWithTimeZone}}</span>
                                                </app-no-data-label>
                                            </span>
                                        </div>
                                        <div class="col">
                                            <span class="coi-text-dark d-block"><ng-container i18n="@@COMMON_SUBMISSION">Certification</ng-container></span>
                                            <span class="coi-text-light">
                                                <app-no-data-label [valueToShow]="opa?.opaDisclosure?.submissionTimestamp">
                                                    <span>{{opa?.opaDisclosure?.submissionTimestamp | dateFormatterWithTimeZone}}</span>
                                                </app-no-data-label>
                                            </span>
                                        </div>
                                        <div class="col">
                                            <span class="coi-text-dark d-block">Expiration</span>
                                            <span class="coi-text-light">
                                                <app-no-data-label [valueToShow]="opa?.opaDisclosure?.expirationDate">
                                                    <span>{{opa?.opaDisclosure?.expirationDate | dateFormatterWithTimeZone}}</span>
                                                </app-no-data-label>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div [ngClass]="isShowAdminDetails ? 'col-12 col-lg-6 col-xxl-4 mt-4 mt-xxl-0' : 'col-6'">
                                <div class="coi-box-red border border-secondary border-opacity-50 fw-medium p-3 rounded-1 h-100 position-relative">
                                    <span class="coi-text-darker fs-6 coi-field-set">Status</span>
                                    <div class="row row-gap-2">
                                        <div class="col-4 col-lg-4 col-xl-6">
                                            <label class="coi-text-lighter d-block"><ng-container i18n="@@DISCLOSURE_DISPOSITION">Disposition</ng-container>
                                            </label>
                                            <app-no-data-label
                                                 [valueToShow]="opa?.opaDisclosure?.dispositionStatusType?.description">
                                            <span class="{{opaDispositionStatusBadge[opa?.opaDisclosure?.dispositionStatusType?.dispositionStatusCode] || 'yellow-badge'}}"></span>
                                            <span class="coi-text-dark">
                                                {{opa?.opaDisclosure?.dispositionStatusType?.description}}
                                            </span>
                                            </app-no-data-label>
                                        </div>
                                        <div class="col-4 col-lg-4 col-xl-6">
                                            <label class="coi-text-lighter d-block"><ng-container i18n="@@OPA_DISCLOSURE_REVIEW_STATUS">Review</ng-container>
                                            </label>
                                            <app-no-data-label
                                                [valueToShow]="opa?.opaDisclosure?.reviewStatusType?.description">
                                            <span class="{{opaReviewStatusBadge[opa?.opaDisclosure?.reviewStatusType?.reviewStatusCode] || 'red-badge'}}"></span>
                                            <span class="coi-text-dark">
                                                {{opa?.opaDisclosure?.reviewStatusType?.description}}
                                            </span>
                                            </app-no-data-label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xxl-3 col-xl-4 p-3 action-header-border">
                    <div class="h-100">
                        <div class="d-flex flex-wrap gap-2">
                            <!-- Close -->
                            <button (click)="routeToOpaOrUserDashboard()" id="opa_back_btn"
                                class="d-inline-flex align-items-center justify-content-center btn btn-outline-grey col fs-14"
                                title="Click here to close"  aria-label="Click here to close">
                                <mat-icon aria-hidden="true">close</mat-icon>
                                <span class="ms-2">Close</span>
                            </button>
                            <!-- Comment -->
                            <button *ngIf="isShowCommentBtn" title="Click here to add new comment"
                                (click)="openReviewComment()" id="opa_add_comments_btn" aria-label="Click here to add new comment"
                                class="d-flex align-items-center justify-content-center btn btn-outline-grey col fs-14 text-nowrap">
                                <mat-icon aria-hidden="true" class="me-2">rate_review</mat-icon>
                                <span>All Comments</span>
                                <span *ngIf="opa?.disclosureCommentsCount?.totalCount > 0">({{ opa?.disclosureCommentsCount?.totalCount > 99 ? '99+' : opa?.disclosureCommentsCount?.totalCount }})</span>
                            </button>
                             <!-- Revise -->
                            <button *ngIf="isShowReviseButton" title="Click here to revise OPA"
                                (click)="reviseOPA()" id="opa_revise_btn" aria-label="Click here to revise OPA"
                                class="d-flex align-items-center justify-content-center btn btn-success col fs-14">
                                <mat-icon aria-hidden="true" class="me-1 flex-shrink-0">restart_alt</mat-icon>
                                <span>Revise</span>
                            </button>
                            <!-- More Option -->
                            <button [matMenuTriggerFor]="beforeMenu"
                                class="d-inline-flex align-items-center justify-content-center btn btn-outline-grey col fs-14"
                                title="Click here for more actions" id="opa_more_actions_btn" aria-label="Click here for more actions">
                                <mat-icon aria-hidden="true" class="moreActionIcon">more_vert</mat-icon>
                            </button>
                            <!-- Submit -->
                            <button *ngIf="dataStore.isFormEditable()" 
                                [disabled]="commonService?.autoSaveSavingSpinner !== 'HIDE' || commonService?.hasChangesAvailable"
                                (click)="certifyAndSubmit()" id="opa_submit_btn"
                                class="d-inline-flex align-items-center justify-content-center btn btn-primary col fs-14"
                                [ngClass]="{'col-12': isCardExpanded}"
                                title="Click here to submit disclosure" aria-label="Click here to submit disclosure">
                                <mat-icon aria-hidden="true">done</mat-icon>
                                <span class="ms-2">Submit</span>
                            </button>
                            <!-- Assign Admin -->
                            <button *ngIf="isShowAssignAdminBtn" title="Click here to assign administrator/admin group"
                                class="d-inline-flex align-items-center justify-content-center btn btn-primary fs-14 col"
                                [ngClass]="{'col-12': isCardExpanded}"
                                aria-label="Click here to assign administrator/admin group" (click)="openAddAssignModal()" id="opa_assign_admin_btn">
                                <mat-icon aria-hidden="true">group_add</mat-icon>
                                <span class="ms-2 text-nowrap">Assign Admin</span>
                            </button>
                            <div *ngIf="isShowApproveDisapproveBtn" class="d-flex align-items-center col-12 gap-2">
                                <!-- Return -->
                                <button id="opa-routing-disapprove-btn"
                                    class="d-inline-flex align-items-center justify-content-center btn btn-outline-grey col fs-14"
                                    title="Click here to return disclosure" aria-label="Click here to return disclosure"
                                    (click)="disapproveOPARouting()">
                                    <mat-icon aria-hidden="true" class="returnIcon">refresh</mat-icon>
                                    <span class="ms-2">Return</span>
                                </button>
                                <!-- Approve -->
                                <button id="opa-routing-approve-btn"
                                    class="d-inline-flex align-items-center justify-content-center btn btn-primary col fs-14"
                                    title="Click here to approve disclosure" aria-label="Click here to approve disclosure"
                                    (click)="routingAction('APPROVE')">
                                    <mat-icon aria-hidden="true">done</mat-icon>
                                    <span class="ms-2">Approve</span>
                                </button>
                            </div>
                            <!-- Complete Final Review -->
                            <button *ngIf="isShowCompleteFinalReviewBtn"
                                class="d-flex justify-content-center align-items-center fs-14 btn btn-primary col w-100"
                                [ngClass]="{'col-12': isCardExpanded}"
                                aria-label="Complete Final Review" id="opa_complete_review_btn" title="Click here to complete final review"
                                data-bs-target="#completeReviewModalFromDashboard" data-bs-toggle="modal">
                                <mat-icon aria-hidden="true" class="me-2">done</mat-icon>
                                <span class="text-nowrap">Complete Final Review</span>
                            </button>
                            <!-- Start Review -->
                            <button *ngIf="isShowStartReviewBtn"
                                title="Click here to start review" id="opa_start_reviewer_review_btn" aria-label="Click here to start review"
                                (click)="updateOpaReview('START')"
                                class="d-flex justify-content-center align-items-center fs-14 btn btn-primary w-100">
                                <mat-icon aria-hidden="true" class="material-icons-outlined">play_circle_filled</mat-icon>
                                <span class="mt-1 ms-2">Start Review</span>
                            </button>
                            <!-- Complete Review -->
                            <button *ngIf="isShowCompleteReviewBtn"
                                title="Click here to complete review" id="opa_complete_reviewer_review_btn"
                                aria-label="Click here to complete review" (click)="updateOpaReview('COMPLETE')"
                                class="d-flex justify-content-center align-items-center fs-14 btn btn-primary w-100">
                                <mat-icon aria-hidden="true" class="material-icons-outlined">stop_circle</mat-icon>
                                <span class="mt-1 ms-2">Complete Review</span>
                            </button>
                            <!-- Last Updated By -->
                            <div *ngIf="isCardExpanded" class="fs-14 ash-text col-12">
                                <label class="coi-text-lighter fs-13 fw-medium d-block">Last Updated By</label>
                                <span class="coi-text-dark fs-13 fw-normal">{{opa?.opaDisclosure?.updateUserFullName}}<span class="coi-text-lighter fs-13 fw-medium"> On </span> {{opa?.opaDisclosure?.updateTimestamp |
                                    dateFormatterWithTimeZone:'long'}}</span>
                            </div>
                        </div>
                    </div>
                    <mat-menu #beforeMenu="matMenu" xPosition="before">
                        <!-- Reassign Admin -->
                        <button *ngIf="isShowReAssignAdminBtn" mat-menu-item id="opa_reassign_admin"
                            title="Click here to reassign administrator/admin group"
                            aria-label="Click here to reassign administrator/admin group"
                            class="more-action" (click)="openAddAssignModal();">
                            <mat-icon aria-hidden="true">group_add</mat-icon>
                            <span class="ms-2 fw-medium fs-14">Reassign Admin</span>
                        </button>

                        <!-- Recalled option only shown for reviewStatusCode(2-submitted)-->
                        <!-- check logged person & disclosure created person is same -->
                        <button *ngIf="isShowWithdrawBtn" mat-menu-item id="opa_recall"
                            title="Click here to Recall disclosure" aria-label="Click here to Recall disclosure" class="more-action"
                            (click)="openConfirmationModal('Recall', withdrawHelpTexts, withdrawErrorMsg, withdrawModalHelpText);">
                            <mat-icon aria-hidden="true">logout</mat-icon>
                            <span class="ms-2 fw-medium fs-14">Recall</span>
                        </button>

                        <!-- return to pi -->
                        <!-- reviewStatusCode-(3-Review In Progress, 7-Review Assigned, 8-Assigned Review Completed) -->
                        <!-- Check logged person and administrator are same -->
                        <button *ngIf="isShowReturnBtn" mat-menu-item  id="opa_return"
                            title="Click here to return disclosure" aria-label="Click here to return disclosure" class="more-action"
                            (click)="openConfirmationModal('Return', returnHelpTexts, returnErrorMsg, returnModalHelpText);">
                            <mat-icon aria-hidden="true" class="returnIcon">refresh</mat-icon>
                            <span class="ms-1 fw-medium fs-14">Return</span>
                        </button>

                        <!-- Print -->
                        <button mat-menu-item id="opa-disclosure-print-btn"
                            title="Click here to print disclosure" aria-label="Click here to print disclosure"
                            (click)="openPrintDisclosureModal()"
                            class="text-nowrap border-0 rounded-0 btn btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action">
                            <mat-icon aria-hidden="true">print</mat-icon>
                            <span class="ms-1 fw-medium fs-14">Print Disclosure</span>
                        </button>
                    </mat-menu>
                </div>
            </div>
        </div>
        <!-- new top card ends -->
    </div>
    <!-- Sub Tab Nav Bar -->
    <div class="col-lg-12 mt-1">
        <div class="d-flex align-items-center coi-navigation-tabs">
            <!-- Disclosure -->
            <div [routerLink]="[OPA_CHILD_ROUTE_URLS.FORM]" class="navigation-box border-end" queryParamsHandling='merge'
                [attr.aria-label]="router.url.includes(OPA_CHILD_ROUTE_URLS.FORM) ? 'Disclosure' : 'Click here to view the Disclosure'"
                [title]="router.url.includes(OPA_CHILD_ROUTE_URLS.FORM) ? 'Disclosure' : 'Click here to view the Disclosure'" role="button">
                <span class="navigation-box-content" routerLinkActive="active">Disclosure</span>
            </div>
            <!-- Reviews -->
            <div *ngIf="isShowReviewTab" [routerLink]="[OPA_CHILD_ROUTE_URLS.REVIEW]" class="navigation-box border-end" queryParamsHandling='merge'
                role="button" [attr.aria-label]="router.url.includes(OPA_CHILD_ROUTE_URLS.REVIEW) ? 'Reviews' : 'Click here to view the Reviews'"
                [title]="router.url.includes(OPA_CHILD_ROUTE_URLS.REVIEW) ? 'Reviews' : 'Click here to view the Reviews'" role="button">
                <span class="navigation-box-content" routerLinkActive="active">Reviews</span>
            </div>
            <!-- Route Log -->
            <div *ngIf="isShowRouteLogTab" [routerLink]="[OPA_CHILD_ROUTE_URLS.ROUTE_LOG]" class="navigation-box border-end" queryParamsHandling='merge'
                [attr.aria-label]="router.url.includes(OPA_CHILD_ROUTE_URLS.ROUTE_LOG) ? 'Route Log' : 'Click here to view the Route Log'"
                [title]="router.url.includes(OPA_CHILD_ROUTE_URLS.ROUTE_LOG) ? 'Route Log' : 'Click here to view the Route Log'" role="button">
                <span class="navigation-box-content" routerLinkActive="active">Route Log</span>
            </div>
            <!-- History -->
            <div [routerLink]="[OPA_CHILD_ROUTE_URLS.HISTORY]" class="navigation-box" queryParamsHandling='merge' title="click here to view history"
                [attr.aria-label]="router.url.includes(OPA_CHILD_ROUTE_URLS.HISTORY) ? 'History' : 'Click here to view the History'"
                [title]="router.url.includes(OPA_CHILD_ROUTE_URLS.HISTORY) ? 'History' : 'Click here to view the History'" role="button">
                <span class="navigation-box-content" routerLinkActive="active">History</span>
            </div>

            <div *ngIf="dataStore.isFormEditable()" class="d-inline-flex position-relative align-items-center ms-auto">
                <!-- save toast and loader -->
                <div class="saved-toast-position invisible py-1 align-items-center badge d-inline-flex fw-normal fs-13 px-2 rounded-5 text-bg-light-success"
                    id="success-toast">
                    <span class="me-1">Last saved at {{ autoSaveService.lastSavedTime }}</span>
                    <mat-icon aria-hidden="true" class="coi-success-icon">cloud_done</mat-icon>
                </div>
                <div *ngIf="commonService?.autoSaveSavingSpinner !== 'HIDE'" id="inprogress-toast"
                    class="saved-toast-position py-1 align-items-center d-inline-flex fw-normal px-2 rounded-5">
                    <span class="me-1 fs-14">Saving...</span>
                    <mat-icon aria-hidden="true" class="text-success fw-600 coi-rotating">autorenew</mat-icon>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-container *ngIf="showSlider">
    <app-person-related-sliders (closePage)="closeHeaderSlider($event)" for="OPA"
        [personId]="opa?.opaDisclosure?.personId" [sliderType]="selectedType"
        [personName]="opa?.opaDisclosure?.personName">
    </app-person-related-sliders>
</ng-container>

<div>
    <router-outlet></router-outlet>
</div>

<app-assign-administrator-modal *ngIf="isAddAssignModalOpen" (closeModal)="closeAssignAdministratorModal($event)"
                                [disclosureNumber]="opa?.opaDisclosure?.opaDisclosureNumber" [actionType]="opa?.opaDisclosure?.adminPersonId ? 'R' : 'A'"
                                [path]="'OPA_DISCLOSURES'" [disclosureId]="opa?.opaDisclosure?.opaDisclosureId" [currentAssignedAdminId]="opa?.opaDisclosure?.adminPersonId"
                                [defaultAdminDetails]="defaultAdminDetails">
</app-assign-administrator-modal>

<!--Disclosure Recall/Return Confirmation Modal-->
<app-confirmation-modal [modalName]="'disclosure-confirmation-modal'"
                        (primaryBtnAction)="performDisclosureAction($event)"
                        [primaryBtnName]="primaryBtnName" [modalSize]="'lg'"
                        [textAreaLabelName]="'Reason for ' + textAreaLabelName"
                        [helpText]="helpTexts"
                        [needDescriptionField]="true" [isMandatory]="true" [descriptionErrorMsg]="descriptionErrorMsg"
                        [primaryBtnTooltip]= "'Click here to '+ primaryBtnName.toLowerCase() +' the disclosure.'" [secondaryBtnTooltip]= "'Click here to cancel'">
    <!-- modal header -->
    <ng-container header>
        <span>{{primaryBtnName}} OPA Disclosure</span>
        <app-common-help-text *ngIf="confirmationHelpTexts" [helpTextHardCoded]="confirmationHelpTexts"></app-common-help-text>
    </ng-container>
</app-confirmation-modal>

<!-- Complete review modal -->
<div tabindex="-1" class="modal modal-coi fade mySkinDialog" data-bs-backdrop="static" id="completeReviewModalFromDashboard"
    role="dialog" aria-label="complete Final Review">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header pe-0">
                <h4 class="modal-title">
                    <span>Complete Final Review</span>
                    <app-common-help-text [helpTextHardCoded]="completeReviewHelpText"></app-common-help-text>
                </h4>
                <button aria-label="Click here to close" class="btn-close fs-12" (click)="clearCompleteReviewModal()"
                    data-bs-dismiss="modal" id="opa-complete-final-review-close-btn" title="Click here to close" type="button">
                </button>
            </div>
            <div class="modal-body">
                <div class="row gap-3">
                    <app-person-project-entity-card [personProjectOrEntity]="personProjectDetails"></app-person-project-entity-card>
                    <!-- Description -->
                    <div class="col-12">
                        <label for="opa-complete-review-description" class="fw-600 fs-14 col-12 pb-1">
                            <span>Please provide your assessment of the disclosure</span>
                        </label>
                        <div class="col-12">
                            <textarea id="opa-complete-review-description" name="opa-complete-review-description" rows="4" appLengthValidator
                                [isShowLimiter]='true' [limit]="2000" class="form-control fs-14" autocomplete="off"
                                [(ngModel)]="reviewDescription" (ngModelChange)="reviewDescription = reviewDescription.trim()"
                                [placeholder]="'Please enter the description'">
                            </textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary fs-14" (click)="clearCompleteReviewModal()"
                    data-bs-dismiss="modal" id="opa-complete-final-review-cancel-btn"
                    title="Click here to cancel" aria-label="Click here to cancel" type="button">
                    Cancel
                </button>
                <button (click)="completeDisclosureReview()" class="btn btn-primary fs-14" id="opa-complete-final-review-compelete-btn" title="Click here to complete final review" aria-label="Click here to complete final review" data-bs-dismiss="modal"
                        type="button">Complete Final Review
                </button>
            </div>
        </div>
    </div>
</div>
<app-reviewer-action-modal *ngIf="opaService.isEnableReviewActionModal"></app-reviewer-action-modal>

<!--opa submit confirmation modal-->
<div class="modal fade mySkinDialog" tabindex="-1" id="opa-submit-confirm-modal" role="dialog" data-backdrop="static"
    data-keyboard="false" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header" id="opa-submit-confirmation-header">
                <h4 class="fs-16">
                    <span>Submit OPA Disclosure</span>
                    <app-common-help-text [helpTextHardCoded]="submitHelpTexts"></app-common-help-text>
                </h4>
                <button type="button" id="opa-submit-close-btn" class="btn-close fs-12" data-bs-dismiss="modal"
                    aria-label="Click here to close" title="Click here to close">
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12 mt-2">
                           <p class="fs-14">Are you sure you want to submit the <strong>OPA</strong> disclosure?</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <ng-container>
                    <button class=" btn btn-outline-secondary" data-bs-dismiss="modal" id="opa-submit-dismiss-btn" aria-label="Click here to cancel" title="Click here to cancel">Cancel</button>
                    <button (click)="saveAndSubmit()" class=" btn btn-primary fs-14" data-bs-dismiss="modal"
                        id="opa-submit-btn" title="Click here to submit">Submit</button>
                </ng-container>
            </div>
        </div>
    </div>
</div>

<div *ngIf="isShowCompleteDisclHistory">
    <app-complete-disclosures-history-slider [disclosureDetails]="opa?.opaDisclosure" (closePage)="closeCompleteDisclosureHistorySlider($event)"> </app-complete-disclosures-history-slider>
</div>

<!--Unsaved Changes confirmation Modal-->
<app-confirmation-modal [modalName] = "'opa-unsaved-changes-modal'" (secondaryBtnAction)="leavePageClicked()"
                        [primaryBtnName]="'Stay On Page'" [secondaryBtnName]="'Leave Page'">
    <!-- modal header -->
    <ng-container header>
        <span>Confirmation</span>
    </ng-container>
    <!-- modal content -->
    <div content class="ms-2">
        <p class="fs-14">Are you sure you want to leave the page without saving?</p>
    </div>
</app-confirmation-modal>
<!--Unsaved Changes confirmation Modal end-->

<app-form-validator [validationList]="validationList" [validationConfig]="opaService.validationConfig"></app-form-validator>

<!-- engagement slider -->
<ng-container *ngIf="opaService.coiEngagementSliderConfig?.personEntityId">
    <app-coi-slider (closeSlider)="opaService.closeEngagementSlider()"
        [elementId]="opaService.coiEngagementSliderConfig?.sliderElementId">
        <ng-container content>
            <app-entity-details [entityId]="opaService.coiEngagementSliderConfig?.personEntityId"></app-entity-details>
        </ng-container>
    </app-coi-slider>
</ng-container>

<!-- new engagement slider -->
<div *ngIf="opaService.isShowCreateEngSlider">
    <app-add-sfi-slider [(isOpenSlider)]="opaService.isShowCreateEngSlider"></app-add-sfi-slider>
</div>

<app-activate-inactivate-sfi-modal *ngIf="opaService.engActivateInactivateModal?.personEntityId" [entityName]="engActivateInactivateModal?.entityName"
    [personEntityId]="opaService.engActivateInactivateModal?.personEntityId" [updatedRelationshipStatus]="opaService.engActivateInactivateModal?.updatedRelationshipStatus"
    (closeModal)="closeActivateInactivateSfiModal($event)" [personEntityNumber]="opaService.engActivateInactivateModal?.personEntityNumber"
    [isSignificantFinInterest]="opaService.engActivateInactivateModal?.isSignificantFinInterest"
    [relationshipDetails]="opaService.engActivateInactivateModal?.relationshipDetails">
</app-activate-inactivate-sfi-modal>

<!-- Routing Approve / Return Confirmation Modal -->
<app-common-modal [modalConfig]="workFlowConfirmModalConfig" (modalAction)="postWorkFlowConfirmation($event)">
    <ng-container modal-header>
        <span>{{ approveOrRejectWorkflowRO.actionType === 'A' ? 'Approve' : 'Return' }} OPA Disclosure</span>
    </ng-container>
    <ng-container modal-body>
        <div class="row row-gap-2">
            <!-- Text Box Comment -->
            <div class="col-12">
                <!-- Comment -->
                <label for="opa-wf-modal-confirm-reason" class="coi-text-dark pb-1"
                    [attr.aria-label]="'Please enter the reason for ' + (approveOrRejectWorkflowRO.actionType === 'A' ? 'approval' : 'return')">
                    <span class="text-danger pe-1">*</span>
                    <span>Reason for {{ approveOrRejectWorkflowRO.actionType === 'A' ? 'Approval' : 'Return' }}</span>
                    <app-common-help-text></app-common-help-text>
                </label>
                <div class="position-relative">
                    <!-- text box -->
                    <textarea id="opa-wf-modal-confirm-reason" rows="4" appLengthValidator [isShowLimiter]="true"
                        [limit]="2000" class="form-control fs-14" autocomplete="off"
                        [(ngModel)]="approveOrRejectWorkflowRO.approveComment"
                        (ngModelChange)="validateWorkFlowApproveReject()" [ngClass]="{ 'is-invalid d-block': workFlowMandatoryList?.has('COMMENT') }"
                        [placeholder]="'Please enter the reason for ' + (approveOrRejectWorkflowRO.actionType === 'A' ? 'approval' : 'return')">
                    </textarea>
                    <!-- error -->
                    <span *ngIf="workFlowMandatoryList?.has('COMMENT')" class="position-absolute d-block fs-13 invalid-feedback">{{ workFlowMandatoryList?.get('COMMENT') }}</span>
                </div>
            </div>

            <!-- Attachment -->
            <div class="col-12">
                <label for="opa-wf-modal-confirm-att" class="coi-text-dark pb-1"
                    [attr.aria-label]="'Please enter the reason for ' + (approveOrRejectWorkflowRO.actionType === 'A' ? 'approval' : 'return')">
                    <span>Add Files</span>
                    <app-common-help-text></app-common-help-text>
                </label>
                <!-- file drop -->
                <div>
                    <app-file-drop [multiple]="true" [fileAccept]="commonService.generalFileType"
                        (filesDropEvent)="fileDrop($event)"></app-file-drop>
                </div>
            </div>
            <!-- files -->
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                <div *ngIf="WorkflowUploadedFiles?.length" class="coi-file-chip-container">
                    <ng-container *ngFor="let file of WorkflowUploadedFiles; let fileIndex = index;">
                        <span class="coi-file-chips rounded-pill">
                            <span class="me-1 fs-12">{{file?.name}}</span>
                            <button id="coi-foreign-name-delete-{{fileIndex}}" class="d-flex btn-none"
                                (click)="deleteFromUploadedFileList(fileIndex)"
                                title="click here to remove file: {{file?.name}}"
                                attr.aria-label="click here to remove file: {{file?.name}}">
                                <mat-icon class="fileChips-close fs-13" aria-hidden="true">clear</mat-icon>
                            </button>
                        </span>
                    </ng-container>
                </div>
            </div>
            <!-- error -->
            <span *ngIf="attachmentErrorMsg" class="mandatory fs-14">{{ attachmentErrorMsg }}</span>
        </div>
    </ng-container>
</app-common-modal>

<ng-container *ngIf="opaService.deleteEngagementModalDetails?.engagementDetails?.personEntityId">
    <app-common-modal [modalConfig]="opaService.deleteEngagementModalDetails?.engDeleteModalConfig" (modalAction)="postEngDeleteConfirmation($event)">
        <ng-container modal-header>
            <span>Confirmation</span>
        </ng-container>
        <ng-container modal-body>
            <p>Are you sure you want to delete the engagement <strong>"{{ opaService.deleteEngagementModalDetails?.engagementDetails?.entityName }}"</strong>?</p>
        </ng-container>
    </app-common-modal>
</ng-container>

<!-- disclosure print  -->
<app-coi-print-modal *ngIf="printModalConfig.isOpenPrintModal"
    [printModalConfig]="printModalConfig" (modalClosed)="printModalClosed()">
</app-coi-print-modal>
