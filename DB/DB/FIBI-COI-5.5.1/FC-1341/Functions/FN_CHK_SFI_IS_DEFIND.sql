DELIMITER //
CREATE FUNCTION FN_CHK_SFI_IS_DEFIND(
    AV_DISCLOSURE_ID INT 
) RETURNS varchar(6)
    DETERMINISTIC
BEGIN
	DECLARE LI_RELATIONSHIP_FLAG INT DEFAULT 0;

  	  SELECT COUNT(*) INTO LI_RELATIONSHIP_FLAG
  	  FROM COI_DISCL_PROJECT_ENTITY_REL T1
  	  INNER JOIN COI_DISCL_PROJECTS T4 ON T4.COI_DISCL_PROJECTS_ID = T1.COI_DISCL_PROJECTS_ID
  	  INNER JOIN PERSON_ENTITY_RELATIONSHIP T2 ON T1.PERSON_ENTITY_ID = T2.PERSON_ENTITY_ID
        INNER JOIN VALID_PERSON_ENTITY_REL_TYPE T3 ON T2.VALID_PERS_ENTITY_REL_TYP_CODE = T3.VALID_PERS_ENTITY_REL_TYP_CODE
  	  WHERE T4.DISCLOSURE_ID = AV_DISCLOSURE_ID
  	  AND T1.PROJECT_CONFLICT_STATUS_CODE IS NULL
  	  AND T1.PERSON_ENTITY_ID IS NOT NULL
  	  AND T3.DISCLOSURE_TYPE_CODE = 1;
	  
	  IF LI_RELATIONSHIP_FLAG > 0 THEN 
	  RETURN 'FALSE';     
	  END IF;
 RETURN 'TRUE';
END;
//
