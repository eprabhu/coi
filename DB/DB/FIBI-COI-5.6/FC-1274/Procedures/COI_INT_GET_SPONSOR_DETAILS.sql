DELIMITER //
CREATE PROCEDURE COI_INT_GET_SPONSOR_DETAILS(IN AV_ENTITY_ID INT)
BEGIN
   
      SELECT
        ESI.ENTITY_ID,
        ESI.SPONSOR_CODE,
        SUBSTR(ESI.SPONSOR_NAME, 1, 200) AS SPONSOR_NAME,
        CASE WHEN ESI.PRIMARY_ADDRESS_LINE_1 IS NOT NULL THEN SUBSTR(ESI.PRIMARY_ADDRESS_LINE_1, 1, 80) ELSE NULL END AS SPONSOR_ADDRESS_LINE_1,
        CASE WHEN ESI.PRIMARY_ADDRESS_LINE_2 IS NOT NULL THEN SUBSTR(ESI.PRIMARY_ADDRESS_LINE_2, 1, 80) ELSE NULL END AS SPONSOR_ADDRESS_LINE_2,
        ESI.CITY  AS SPONSOR_CITY,
        ESI.STATE AS SPONSOR_STATE,
        ESI.POST_CODE AS SPONSOR_POST_CODE,
        CASE WHEN ESI.COUNTRY_CODE IS NOT NULL THEN SUBSTR(ESI.COUNTRY_CODE, 1, 80) ELSE NULL END AS SPONSOR_COUNTRY_CODE,
        ESI.EMAIL_ADDRESS,
        ESI.UPDATED_BY,
        ESI.UEI_NUMBER,
        ESI.CAGE_NUMBER,
        ESI.DUNS_NUMBER,
        SUBSTR(ESI.SPONSOR_TYPE_CODE,1,3) AS SPONSOR_TYPE_CODE,
        SUBSTR(ESI.CUSTOMER_NUMBER,1,40) AS CUSTOMER_NUMBER,
        SUBSTR(ESI.AUDIT_REPORT_SENT_FOR_FY,1,4) AS AUDIT_REPORT_SENT_FOR_FY,
        SUBSTR(ESI.ACRONYM,1,10) AS ACRONYM,
        SUBSTR(ESI.DUNNING_CAMPAIGN_ID,1,6) AS DUNNING_CAMPAIGN_ID,
        SUBSTR(ESI.DODAC_NUMBER,1,20) AS DODAC_NUMBER,
        ESI.FEED_STATUS_CODE as SPONSOR_FEED_STATUS_CODE,
        SUBSTR(CONVERT(ESI.PHONE_NUMBER , CHAR),1,20) AS PHONE_NUMBER,
        ESI.COMMENTS
    FROM ENTITY_SPONSOR_INFO ESI
    WHERE ESI.ENTITY_ID = AV_ENTITY_ID
	AND ESI.FEED_STATUS_CODE IN ('2', '4');

END
//
